<%- model_class = Artwork -%>
<div class="row">
  <div class="col-lg-12">
    <h1 class="page-header"><%= @artwork.title %>
      <small><%= @artwork.category_1.name%></small>
    </h1>
  </div>
</div>

<div class="row">
  <div class="col-sm-3">
    <a type="href" data-toggle="modal" data-target="#imageModal" href="">
      <%= image_tag(@artwork.avatar.url(:large), :class => "img-thumbnail", :class => "img-responsive", :style => "margin-left: auto; margin-right: auto;") %>
    </a>
  </div>
  <div class="col-sm-9">
    <ul class="nav nav-tabs">
      <li class="active"><a href="#datos_generales" data-toggle="tab" aria-expanded="false">Datos generales</a></li>
      <li class=""><a href="#desc_img_rel" data-toggle="tab" aria-expanded="false">Descripción, Imagenes y relatos</a></li>
      <li class=""><a href="#personajes" data-toggle="tab" aria-expanded="false">Personajes</a></li>
      <li class=""><a href="#cuerpo_gestos" data-toggle="tab" aria-expanded="false">Cuerpo y gestos</a></li>
      <li class=""><a id="mapTab" href="#location" data-toggle="tab" aria-expanded="false">Lugar</a></li>
    </ul>
    <br>
    <div id="myTabContent" class="tab-content">
      <div class="tab-pane fade active in" id="datos_generales">
        <div class="row">
          <div class="col-md-6">
            <div class="row">
              <label class="control-label col-sm-3">Titulo</label>
              <div class="col-sm-9"><%= @artwork.get_title%></div>
            </div>
            <div class="row">
              <label class="control-label col-sm-3">Autor</label>
              <div class="col-sm-9"><%=@artwork.get_author_name%></div>
            </div>
            <div class="row">
              <label class="control-label col-sm-3">Actividad</label>
              <div class="col-sm-9"><%=@artwork.get_activity%></div>
            </div>
            <div class="row">
              <label class="control-label col-sm-3">Información Biográfica</label>
              <div class="col-sm-9"><%=@artwork.get_biographic_data%></div>
            </div>
            <div class="row">
              <label class="control-label col-sm-3">Firmado</label>
              <div class="col-sm-9"><%=@artwork.get_signed%></div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="row">
              <label class="control-label col-sm-3">Categoría 1</label>
              <div class="col-sm-9"><%=@artwork.get_category_1_name%></div>
            </div>
            <div class="row">
              <label class="control-label col-sm-3">Categoría 2</label>
              <div class="col-sm-9"><%=@artwork.get_category_2_name%></div>
            </div>
            <div class="row">
              <label class="control-label col-sm-3">Categoría 3</label>
              <div class="col-sm-9"><%=@artwork.get_category_3_name%></div>
            </div>
            <div class="row">
              <label class="control-label col-sm-3">Categoría 4</label>
              <div class="col-sm-9"><%=@artwork.get_category_4_name%></div>
            </div>
            <div class="row">
              <label class="control-label col-sm-3">Categoría 5</label>
              <div class="col-sm-9"><%=@artwork.get_category_5_name%></div>
            </div>
          </div>
        </div>
        <br>
        <div class="row">
          <div class="col-md-6">
            <div class="row">
              <label class="control-label col-sm-3">Tipo</label>
              <div class="col-sm-9"><%=@artwork.get_type_name%></div>
            </div>
            <div class="row">
              <label class="control-label col-sm-3">Fuente</label>
              <div class="col-sm-9"><%=@artwork.get_source_name%></div>
            </div>
            <div class="row">
              <label class="control-label col-sm-3">Lugar</label>
              <div class="col-sm-9"><%=@artwork.get_place_name%></div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="row">
              <label class="control-label col-sm-3">Escuela</label>
              <div class="col-sm-9"><%=@artwork.get_school_name%></div>
            </div>
            <div class="row">
              <label class="control-label col-sm-3">Origen</label>
              <div class="col-sm-9"><%=@artwork.get_origin_name%></div>
            </div>
          </div>
        </div>
        <br>
        <div class="row">
          <div class="col-md-6">
            <div class="row">
              <label class="control-label col-sm-3">Sintesis</label>
              <div class="col-sm-9"><%=@artwork.get_synthesis%></div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="row">
              <label class="control-label col-sm-3">Comentario Biográfico</label>
              <div class="col-sm-9"><%=@artwork.get_biographic_comment%></div>
            </div>
          </div>
        </div>
      </div>
      <div class="tab-pane fade in" id="desc_img_rel">
        <div class="row">
          <div class="col-md-6">
            <div class="row">
              <label class="control-label col-sm-3">Escena</label>
              <div class="col-sm-9"><%=@artwork.get_scene_name%></div>
            </div>
            <div class="row">
              <label class="control-label col-sm-3">Tipo de relato</label>
              <div class="col-sm-9"><%=@artwork.get_story_type_name%></div>
            </div>
            <div class="row">
              <label class="control-label col-sm-3">Donante</label>
              <div class="col-sm-9"><%=@artwork.get_donor_name%></div>
            </div>
            <div class="row">
              <label class="control-label col-sm-3">Cartelera Filacteria</label>
              <div class="col-sm-9"><%=@artwork.get_phylactery_billboard_name%></div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="row">
              <label class="control-label col-sm-3">Comentarios</label>
              <div class="col-sm-9"><%=@artwork.get_comment%></div>
            </div>
          </div>
        </div>
      </div>
      <div class="tab-pane fade in" id="location">
        <div class="row">
          <div class="col-md-6">
            <div class="row">
              <div class="col-sm-12">
                <label style="text-align: left">Lugar de origen</label>
              </div>
              <div class="col-sm-12">
                <div id="mapOrigin" class="well"></div>
              </div>
            </div>
            <div class="row">
              <label class="control-label col-sm-3">Latitud</label>
              <div class="col-sm-9"><%=@artwork.latitude_origin%></div>
            </div>
            <div class="row">
              <label class="control-label col-sm-3">Longitud</label>
              <div class="col-sm-9"><%=@artwork.longitude_origin%></div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="row">
              <div class="col-sm-12">
                <label style="text-align: right">Lugar actual</label>
              </div>
              <div class="col-sm-12">
                <div id="mapCurrent" class="well"></div>
              </div>
            </div>
            <div class="row">
              <label class="control-label col-sm-3">Latitud</label>
              <div class="col-sm-9"><%=@artwork.latitude_current%></div>
            </div>
            <div class="row">
              <label class="control-label col-sm-3">Longitud</label>
              <div class="col-sm-9"><%=@artwork.longitude_current%></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<br>

<%= link_to t('.back', :default => t("helpers.links.back")),
            artworks_path(@artwork,:parent_id => @artwork.category_1.id) , :class => 'btn btn-default' %>
<%= link_to t('.edit', :default => t("helpers.links.edit")),
            edit_artwork_path(@artwork,:parent_id => @artwork.category_1.id) , :class => 'btn btn-default' %>
<%= link_to t('.destroy', :default => t("helpers.links.destroy")),
            artwork_path(@artwork,:parent_id => @artwork.category_1.id) ,
            :method => 'delete',
            :data => {:confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?'))},
            :class => 'btn btn-danger' %>

<!-- Modal for image view -->
<div class="modal fade" id="imageModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <% if @artwork.save %>
            <h4 class="modal-title" id="myModalLabel"><%= "#{@artwork.title} - #{@artwork.author.name} "%></h4>
        <% end %>
      </div>
      <div class="modal-body">
        <%= image_tag @artwork.avatar.url, :id => "zoomableImage", :class => "img-thumbnail", :class => "img-responsive", 'data-zoom-image' => @artwork.avatar.url, :style => "margin-left: auto; margin-right: auto;" %>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
      </div>
    </div>
  </div>
</div>

<script src="http://maps.googleapis.com/maps/api/js?key=AIzaSyDY0kkJiTPVd2U7aTOAwhc9ySH6oHxOIYM&sensor=false">
</script>
<style>
    .zoomContainer{ z-index: 9999;}
    .zoomWindow{ z-index: 9999;}
</style>
<script>
    //Zoomable Image with ElevateZoom
    $("#zoomableImage").elevateZoom({ zoomType  : "inner", cursor: "crosshair" });

    $('#imageModal').on('shown.bs.modal', function() {
        $("#zoomableImage").elevateZoom({
            zoomType  : "lens",
            lensShape : "round",
            lensSize : 200,
            scrollZoom : true,
            containLensZoom : true,
        });
    });

    jQuery('#imageModal').on('hidden.bs.modal', function (e) {
        jQuery.removeData(jQuery('#zoomableImage'), 'elevateZoom');//remove zoom instance from image
        jQuery('.zoomContainer').remove();// remove zoom container from DOM
    });



    //Google maps
    var initialize;
    initialize = function() {
        infowindow = new google.maps.InfoWindow();
        var latlngOrigin = new google.maps.LatLng(<%= @artwork.latitude_origin %>,<%= @artwork.longitude_origin %>);
        var latlngCurrent = new google.maps.LatLng(<%= @artwork.latitude_current %>,<%= @artwork.longitude_current %>);

        var originProp = {
            disableDefaultUI: true,
            zoomControl: true,
            zoomControlOptions: {
                style: google.maps.ZoomControlStyle.DEFAULT,
                position: google.maps.ControlPosition.RIGHT_TOP
            },
            center: latlngOrigin,
            zoom: 5,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        var currentProp = {
            disableDefaultUI: true,
            zoomControl: true,
            zoomControlOptions: {
                style: google.maps.ZoomControlStyle.DEFAULT,
                position: google.maps.ControlPosition.RIGHT_TOP
            },
            center: latlngCurrent,
            zoom: 5,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        var mapOrigin = new google.maps.Map(document.getElementById("mapOrigin"), originProp);
        $("#mapTab").on('shown.bs.tab', function() {

            /* Trigger map resize event */
            google.maps.event.trigger(mapOrigin, 'resize');
            mapOrigin.setCenter(latlngOrigin);
        });
        var mapCurrent = new google.maps.Map(document.getElementById("mapCurrent"), currentProp);
        $("#mapTab").on('shown.bs.tab', function() {

            /* Trigger map resize event */
            google.maps.event.trigger(mapCurrent, 'resize');
            mapCurrent.setCenter(latlngCurrent);
        });

        $("#mapOrigin").css("width", '100%').css("height", 400);
        var markerOrigin = new google.maps.Marker({
            position: latlngOrigin,
            map: mapOrigin,
            draggable:false,
            icon: pinSymbol("#A12E33"),
            title: 'Ubicación de origen'
        });
        $("#mapCurrent").css("width", '100%').css("height", 400);
        var markerCurrent = new google.maps.Marker({
            position: latlngCurrent,
            map: mapCurrent,
            draggable:false,
            icon: pinSymbol("#F15E00"),
            title: 'Ubicación actual'
        });

        function pinSymbol(color) {
            return {
                path: 'M 0,0 C -2,-20 -10,-22 -10,-30 A 10,10 0 1,1 10,-30 C 10,-22 2,-20 0,0 z',
                fillColor: color,
                fillOpacity: 1,
                strokeColor: '#000',
                strokeWeight: 2,
                scale: 1
            };
        }
    }
    google.maps.event.addDomListener(window, 'load', initialize);

    $(document).ready(initialize);
    $(initialize);
    $(document).on('page:load ready',initialize);
    $(document).on('ready', initialize);

</script>

<% content_for :css_application do %>
    <%= stylesheet_link_tag "artworks_show" %>
<% end %>